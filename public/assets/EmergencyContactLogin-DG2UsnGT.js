import{r as u,c as f,a as t,N as y,w as D,f as _,v as E,t as N,u as C,b,Z as B,n as A,$ as P}from"./index-igiuMsdt.js";const I={class:"min-h-screen flex flex-col items-center justify-center bg-[#EDE8F5] py-8"},z={class:"bg-white rounded-xl shadow-lg p-8 w-full max-w-md"},L=["disabled"],M={key:0,class:"text-red-600 mt-2 text-center"},R={key:1,class:"text-green-600 mt-2 text-center"},$={__name:"EmergencyContactLogin",setup(U){const i=u(""),o=u(""),n=u(!1),r=u(!1),h=C(),m=a=>{const e=a.replace(/\D/g,"");return e.startsWith("0")?"+63"+e.slice(1):e.startsWith("+")?e:"+"+e},x=async()=>{o.value="",n.value=!1,r.value=!0;const a=B(),e=A(a,"users"),s=m(i.value);console.log("Normalized Input Phone:",s);try{const l=await P(e);if(!l.exists()){console.error("No users found in the database."),o.value="No users found in the database.",r.value=!1;return}let c=null;l.forEach(g=>{const p=g.key,d=g.val();console.log("Checking user:",p,d),d.emergencyContacts&&Object.values(d.emergencyContacts).forEach(k=>{const v=m(k.phone);console.log("Comparing:",v,s),v===s&&(c=p)})}),c?(console.log("Found user ID:",c),n.value=!0,setTimeout(()=>{h.push(`/emergency-dashboard/${c}`)},1200)):(console.error("No user found for this contact number."),o.value="No user found for this contact number.")}catch(l){console.error("Error while checking phone number:",l),o.value="An error occurred while checking the phone number. Please try again."}finally{r.value=!1}},w=()=>{h.push("/login")};return(a,e)=>(b(),f("div",I,[t("div",z,[e[2]||(e[2]=t("h2",{class:"text-2xl font-bold text-[#3D52A0] mb-4 text-center"},"Emergency Contact Login",-1)),t("form",{onSubmit:D(x,["prevent"])},[e[1]||(e[1]=t("label",{class:"block text-[#3D52A0] mb-2"},"Mobile Number",-1)),_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),type:"tel",autocomplete:"tel",placeholder:"e.g. 09876543210",class:"w-full px-4 py-2 rounded-lg border border-[#ADBBD4] focus:ring-[#7091E6] focus:border-[#7091E6] mb-4",required:""},null,512),[[E,i.value]]),t("button",{type:"submit",disabled:r.value||n.value,class:"w-full py-2 bg-[#7091E6] text-white rounded-lg font-semibold hover:bg-[#3D52A0] transition disabled:opacity-60"}," Access Dashboard ",8,L)],32),o.value?(b(),f("div",M,N(o.value),1)):y("",!0),n.value?(b(),f("div",R,"Success! Redirecting to dashboard...")):y("",!0),t("button",{onClick:w,class:"w-full mt-4 py-2 bg-[#f82929] text-[rgb(249,250,252)] rounded-lg font-semibold hover:bg-gray-400 transition"}," Back to User Login ")])]))}};export{$ as default};
